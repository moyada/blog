---
title: 分布式事务简单描述
categories: 分布式
date: 2017-12-26 00:15:34
tags:
---


在分布式的数据库存储中，主要的痛点就是如何保证一致性，这个一致性又可分为强一致性、弱一致性和最终一致性。


# 两段式提交(2PC)

两段式提交是将一个完整的事务分为了两个步骤：请求(propose)、提交(commit)或中止(abort)。

这个操作需要由一个中心节点(协调者)往其他分布式节点(参与者)发出，在中心节点发出请求后，需要等待所有节点的决议，根据反馈决定下一步是提交还是会滚。在这个操作的过程中，该事物的所在记录行将不可用。

然而两段式提交仍还有问题，在事务过程中，状态只有中心节点与某一节点互相可知，当事务过程中，中心节点发生宕机，启用备用中心节点时，某一个节点也发生宕机，那么这一方的决议将无人得知，从而，此次的事务将造成死锁，直到节点恢复。


# 三段式提交(3PC)

三段式提交在两段式提交的基础上又增加准备提交阶段来解决两段式提交所存在的问题。

当中心节点接收到反馈后进入准备提交阶段，将接下来将要进行的提交记录，以便回滚，之后再进行提交阶段。

这样当2PC的问题产生时，中心节点便可从状态记录中获取到问题事务，结束事务，同时通知节点。


# Paxos



# Raft





参考:
[http://www.cnblogs.com/bangerlee/p/5268485.html]
[https://www.cnblogs.com/bangerlee/p/5655754.html]
[https://zh.wikipedia.org/zh-cn/Paxos%E7%AE%97%E6%B3%95]
[https://www.cnblogs.com/endsock/p/3480093.html]
[http://www.infoq.com/cn/articles/raft-paper]
[https://zhuanlan.zhihu.com/p/27207160]


